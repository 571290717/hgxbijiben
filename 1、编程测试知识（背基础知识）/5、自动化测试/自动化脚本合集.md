# 自动化脚本合集





一键查工资并截屏

```Python

from selenium import webdriver
from time import sleep
import time

class salary:

    def __init__(self,driver):
        self.driver = driver
    # 定义一个url网页地址Sxzdmv666

    def login(self):
        '''登录'''
        self.driver.find_element_by_xpath('//*[@id="iptUserID"]').send_keys('账号')
        self.driver.find_element_by_xpath('//*[@id="iptPassword"]').send_keys('密码')
        self.driver.find_element_by_xpath('//*[@id="iptEmpNum"]').send_keys('员工编号')
        self.driver.find_element_by_xpath('//*[@id="btnLogin"]').click()#点击登录
        sleep(1)

    def Frame(self):
        '''登录后的操作流程'''
        
    def logout(self):
        '''5秒后关闭'''
        sleep(5)
        driver.close()


    def jieping(self):
        # import time
        # self.time1 = time.strftime("%Y-%m-%d")
        img_name = time.strftime("%Y-%m-%d")
        # self.driver.save_screenshot(f"./{self.time1}.png")
        # # self.driver.save_screenshot("./self.time1.png")
        # img_name = str(time.time()).replace(".", "_")
# 截图并生成图片
        driver.get_screenshot_as_file(r"E:\临时文件\1\工资条\%s.png" % img_name)
        print('截屏成功')





url = 'http://salary.com/PublicNotice/Account/EmpCheckLogin.aspx'
    # 定义driver驱动为谷歌的驱动
driver = webdriver.Chrome()
    # 获取url的网页地址
driver.get(url)


#调用登录模块
salary = salary(driver)
sleep(1)
#调用登录
salary.login()
salary.jieping()
salary.logout()
# salary.logout()

#登录后的操作流程
```

一键加班

```python
from selenium import webdriver
from time import sleep

class Jiaban:

    def __init__(self,driver):
        self.driver = driver
    # 定义一个url网页地址

    def login(self):
        '''登录'''
        self.driver.find_element_by_xpath('//*[@id="txtLoginID"]').send_keys('账号')
        self.driver.find_element_by_xpath('//*[@id="txtPassword"]').send_keys('密码')
        self.driver.find_element_by_xpath('//*[@id="btnLogin"]').click()
        sleep(1)

    def Frame(self):
        '''登录后的操作流程'''
        self.driver.switch_to.frame('frmLeft' )
        self.driver.find_element_by_xpath('//*[@id="lblMenu"]/table/tbody/tr[4]/td/a').click()

        self.driver.switch_to.default_content()#去默认目录

        self.driver.switch_to.frame('frmWorkSpace' )
        self.driver.find_element_by_xpath('//*[@id="txtEmployeeNo"]').send_keys("工号")
        self.driver.find_element_by_xpath('//*[@id="btnGetEmpInfo"]').click()
        sleep(1)

        self.driver.find_element_by_xpath('//*[@id="ddlOTDutyType"]').click()
        self.driver.find_element_by_xpath('//*[@id="ddlOTDutyType"]/option[2]').click()
        sleep(1)
        self.driver.find_element_by_xpath('//*[@id="txtOtContent"]').send_keys('处理待办工作')
        self.driver.find_element_by_xpath('//*[@id="iptEndTime"]').click()
        self.driver.find_element_by_xpath('//*[@id="iptEndTime"]/option[79]').click()


        sleep(1)
        self.driver.find_element_by_xpath('//*[@id="ddlOtType"]').click()
        self.driver.find_element_by_xpath('//*[@id="ddlOtType"]/option[2]').click()
        sleep(2)
        self.driver.find_element_by_xpath('//*[@id="txtTimeProvePerson"]').clear()
        self.driver.find_element_by_xpath('//*[@id="txtTimeProvePerson"]').send_keys("证明人")
        sleep(2)
        self.driver.find_element_by_xpath('//*[@id="DropDownList3"]').click()
        self.driver.find_element_by_xpath('//*[@id="DropDownList3"]/option[2]').click()
        self.driver.find_element_by_xpath('//*[@id="form1"]/table/tbody/tr[1]/td').click()
    def logout(self):
        '''5秒后关闭'''
        sleep(5)
        driver.close()
        





url = 'http://10.2.32.10:9999/OTMesh/Login.aspx'
    # 定义driver驱动为谷歌的驱动
driver = webdriver.Chrome()
    # 获取url的网页地址
driver.get(url)


#调用登录模块
jiaban = Jiaban(driver)
sleep(1)
#调用登录
jiaban.login()


#登录后的操作流程
jiaban.Frame()  

#关闭
jiaban.logout()

```

