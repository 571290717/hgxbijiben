# 办公自动化



## 9、组 织 文 件 

### shutil 模块

import shutil

复制文件和文件夹

shutil.copy(source, destination)，将路径 source 处的文件复制到路径 destination

处的文件夹（source 和 destination 都是字符串）。

该函数返回一个字符串，表示被复制文件的路径。

 >>> ```
 >>> shutil.copy('C:\\spam.txt', 'C:\\delicious')
 >>>  'C:\\delicious\\spam.txt'
 >
 >
 >
 >>> import shutil, os
 >
 >>>  >>> os.chdir('C:\\')
 >>>  >>> shutil.copytree('C:\\bacon', 'C:\\bacon_backup')
 >>>  >>>  'C:\\bacon_backup
 >>>
 >>>  ```

shutil.copytree()调用创建了一个新文件夹，名为 bacon_backup，其中的内容与
 原来的 bacon 文件夹一样。现在你已经备份了非常非常宝贵的“bacon”。



### 文件和文件夹的移动与改名 

shutil.move(source, destination)

source 处的文件夹移动到路径destination，并返回新位置的绝对路径的字符串。



### 永久删除文件和文件夹 

 用 os.unlink(path)将删除 path 处的文件。

• 调用 os.rmdir(path)将删除 path 处的文件夹。该文件夹必须为空，其中没有任

何文件和文件夹。

• 调用 shutil.rmtree(path)将删除 path 处的文件夹，它包含的所有文件和文件夹都

会被删除。



### send2trash 模块安全地删除

shutil.rmtree()函数不可恢复地删除文件和文件夹

pip install send2trash，

利用 send2trash，比 Python 常规的删除函数要安全得多，因为它会将文件夹和文件发送到计算机的垃圾箱或回收站，而不是永久删除它们

```python
>>> import send2trash
>>> baconFile = open('bacon.txt', 'a') # creates the file
>>> baconFile.write('Bacon is not a vegetable.')
25
>>> baconFile.close()
>>> send2trash.send2trash('bacon.txt')
```



### 遍历目录树

os.walk()函数：

```
import os
for folderName, subfolders, filenames in os.walk('C:\\delicious'):
	print('The current folder is ' + folderName)
    for subfolder in subfolders:
        print('SUBFOLDER OF ' + folderName + ': ' + subfolder)
    for filename in filenames:
        print('FILE INSIDE ' + folderName + ': '+ filename)
    print('')



```

os.walk()函数被传入一个字符串值，即一个文件夹的路径。

os.walk()在循环的每次迭代中，返回 3 个值:

​	1．当前文件夹名称的字符串。

2．当前文件夹中子文件夹的字符串的列表。

3．当前文件夹中文件的字符串的列表。

foldername、subfolders 和 filenames。

### 用 zipfile 模块压缩文件

利用 zipfile 模块中的函数，Python 程序可以创建和打开（或解压）ZIP 文件。
 假定你有一个名为 example.zip 的 zip 文件

#### 读取 ZIP 文件

。要创建一个 ZipFile对象，

就调用 zipfile.ZipFile()函数，向它传入一个字符串，表示.zip 文件的文件名。

，zipfile 是 Python 模块的名称，ZipFile()是函数的名称



```python
>>> import zipfile, os
>>> os.chdir('C:\\') # move to the folder with example.zip
>>> exampleZip = zipfile.ZipFile('example.zip')
>>> exampleZip.namelist()
['spam.txt', 'cats/', 'cats/catnames.txt', 'cats/zophie.jpg']
>>> spamInfo = exampleZip.getinfo('spam.txt')
>>> spamInfo.file_size
13908
>>> spamInfo.compress_size
3828

表示字节数的 file_size和 compress_size，它们分别表示原来文件大小和压缩后文件大小
cpmpress  压紧
英[kəmˈpres , ˈkɒmpres]
美[kəmˈpres , ˈkɑːmpres]
v.	(被)压紧; 精简; 浓缩; 压缩(文件等);
n.	(止血、减痛等的)敷布，压布;

 >>> 'Compressed file is %sx smaller!' % (round(spamInfo.file_size / spamInfo
.compress_size, 2))
'Compressed file is 3.63x smaller!'
>>> exampleZip.close()
```

表示字节数的 file_size和 compress_size，它们分别表示原来文件大小和压缩后文件大小

#### 从 ZIP 文件中解压缩



ZipFile 对象的 extractall()方法从 ZIP 文件中解压缩所有文件和文件夹，放到当
 前工作目录中。

```
>>> import zipfile, os
 >>> os.chdir('C:\\') # move to the folder with example.zip
 >>> exampleZip = zipfile.ZipFile('example.zip')
  >>> exampleZip.extractall()
 >>> exampleZip.close()
 
 example.zip 的内容将被解压缩到 C:\。或者，你可以向
 extractall()传递的一个文件夹名称，它将文件解压缩到那个文件夹，而不是当前工作
 目录。如果传递给 extractall()方法的文件夹不存在，它会被创建。
 例如，如果你用
 exampleZip.extractall('C:\\ delicious')取代处的调用，代码就会从 example.zip 中解压
 缩文件，放到新创建的 C:\delicious 文件夹中。
 ZipFile 对象的 extract()方法从 ZIP 文件中解
 例如，如果你用
 exampleZip.extractall('C:\\ delicious')取代处的调用，代码就会从 example.zip 中解压
 缩文件，放到新创建的 C:\delicious 文件夹中。
 
 
 ZipFile 对象的 extract()方法从 ZIP 文件中解压缩单个文件。
 
 exampleZip.extract('spam.txt')
 'C:\\spam.txt'
 >>> exampleZip.extract('spam.txt', 'C:\\some\\new\\folders')
 'C:\\some\\new\\folders\\spam.txt'
 >>> exampleZip.close()


。extract()
 的返回值是被压缩后文件的绝对路径。 
```



import zipfile,os

os.chdir('c:\\')

exampleZip = ZipFile.ZipFile

exampleZip.extractall()#全解压



#### 创建和添加到 ZIP 文件



```
>>> import zipfile
 >>> newZip = zipfile.ZipFile('new.zip', 'w')
 >>> newZip.write('spam.txt', compress_type=zipfile.ZIP_DEFLATED)
 >>> newZip.close()
 
 
 
```

为 zipfile.ZIP_DEFLATED（这指定了 deflate 压缩算法，它对各种类型的数据都很有效）

**w  就是擦除 所有原有的内容，a只将文件添加到原有的 ZIP 文件中**

就像写入文件一样，写模式将擦除 ZIP 文件中所有原有的内容。

如果 只是希望将文件添加到原有的 ZIP 文件中，就要向 zipfile.ZipFile()传入'a'作为第二个参数，以添加模式打开 ZIP 文件。



# 第10章 调试

### 抛出异常

抛出异常使用 raise 语句。在代码中，raise 语句包含以下部分：
 • raise 关键字；
 • 对 Exception 函数的调用；
 • 传递给 Exception 函数的字符串，包含有用的出错信息。

**#raise Exception('This is the error message.')**



#### 取得反向跟踪的字符串

如果 Python 遇到错误，它就会生成一些错误信息，称为“反向跟踪”。

#### 断言

，assert 语句是说：“我断言这个条件为真，如果不为真，程序中什
 么地方就有一个缺陷。”不像异常，代码不应该用 try 和 except 处理 assert 语句。如果
 assert 失败，程序就应该崩溃

```
语法格式如下：

assert expression
等价于：

if not expression:
    raise AssertionError
assert 后面也可以紧跟参数:

assert expression [, arguments]
等价于：

if not expression:
    raise AssertionError(arguments)
```

#### 禁用断言

在运行 Python 时传入-O 选项，可以禁用断言。

#### 使用日志模块

要启用 logging 模块，

```python
import logging
 logging.basicConfig(level=logging.DEBUG, format=' %(asctime)s - %(levelname)s
 - %(message)s')
 logging.debug('Start of program')
 def factorial(n):
  logging.debug('Start of factorial(%s%%)' % (n))
  total = 1
  for i in range(n + 1):
  total *= i
  logging.debug('i is ' + str(i) + ', total is ' + str(total))
  logging.debug('End of factorial(%s%%)' % (n))
  return total
 print(factorial(5))
 logging.debug('End of program')
```

#### 日志级别

DEBUG  logging.debug()  最低级别。用于小细节。通常只有在诊断问题时，你才会关心这些消息
 INFO  logging.info()  用于记录程序中一般事件的信息，或确认一切工作正常

WARNING  logging.warning()  用于表示可能的问题，它不会阻止程序的工作，但将来可能会
 ERROR  logging.error()  用于记录错误，它导致程序做某事失败
 CRITICAL  logging.critical()  最高级别。用于表示致命的错误，它导致或将要导致程序完全停止
 工作

#### 禁用日志

如果想要禁用所有日志，只要在程序中添加 logging. disable
 （logging.CRITICAL）。

>>> logging.disable(logging.CRITICAL)
>>> 

#### 将日志记录到文件

```
import logging
 logging.basicConfig(filename='myProgramLog.txt', level=logging.DEBUG, format='
 %(asctime)s - %(levelname)s - %(message)s')
```

# 第11  章  从 Web 抓取信息



**webbrowser：是 Python 自带的，打开浏览器获取指定页面。
 requests：从因特网上下载文件和网页。
Beautiful Soup：解析 HTML，即网页编写的格式。
 selenium：启动并控制一个 Web 浏览器。selenium 能够填写表单，并模拟鼠标
 在这个浏览器中点击。**



#### 项目：利用 webbrowser 模块的 mapIt.py

```python
>>> import webbrowser
 >>> webbrowser.open('http://inventwithpython.com/')
 Web 浏览器的选项卡将打开 URL http://inventwithpython.com/。
```

#### 用 requests 模块从 Web 下载文件

```
import requests
  >>> res = requests.get('http://www.gutenberg.org/cache/epub/1112/pg1112.txt')
 >>> type(res)
 <class 'requests.models.Response'>
  >>> res.status_code == requests.codes.ok
 True
 >>> len(res.text)
 178981
 >>> print(res.text[:250])
 The Project Gutenberg EBook of Romeo and Juliet, by William Shakespeare
 This eBook is for the use of anyone anywhere at no cost and with
 almost no restrictions whatsoever. You may copy it, give it away or
 re-use it under the terms of the Proje
```



# 第 12 章  处理 Excel 电子表格

#### 安装 openpyxl 模块

 **import openpyxl**

```
>>> import openpyxl
 >>> wb = openpyxl.load_workbook('example.xlsx')
 >>> type(wb)
 <class 'openpyxl.workbook.workbook.Workbook'>
 
 os.getcwd()弄清楚当前工作目录是什么，并使用 os.chdir()改变当前工作目录。
```



#### 从工作簿中取得工作表

```
import openpyxl

wb = openpyxl.load_workbook('example.xlsx')
wb.get_sheet_names()
  *** ['Sheet1', 'Sheet2', 'Sheet3']
sheet = wb.get_sheet_by_name('Sheet3')
sheet
sheet.title
**** 'Sheet3'
 >>> anotherSheet = wb.get_active_sheet()
 >>> anotherSheet
 <Worksheet "Sheet1">
```



**get_active_sheet()方法，取得工作簿的活动表**

在取得 Worksheet对象后，可以通过 title 属性取得它的名称。

#### 从表中取得单元格

```
import openpyxl
 >>> wb = openpyxl.load_workbook('example.xlsx')
 >>> sheet = wb.get_sheet_by_name('Sheet1')
 >>> sheet['A1']
 <Cell Sheet1.A1>
 >>> sheet['A1'].value
 datetime.datetime(2015, 4, 5, 13, 34, 2)
 >>> c = sheet['B1']
 >>> c.value
 'Apples'
 >>> 'Row ' + str(c.row) + ', Column ' + c.column + ' is ' + c.value
 'Row 1, Column B is Apples'
 >>> 'Cell ' + c.coordinate + ' is ' + c.value
 'Cell B1 is Apples'
 >>> >>> sheet['C1'].value
 73
 
 
 
 sheet.cell(row=1, column=2)
 <Cell Sheet1.B1>
 >>> sheet.cell(row=1, column=2).value
 'Apples'
 >>> for i in range(1, 8, 2):
 print(i, sheet.cell(row=i, column=2).value)
 1 Apples
 3 Pears
 5 Apples
 7 Strawberries
 
 
 
 >>> import openpyxl
 >>> wb = openpyxl.load_workbook('example.xlsx')
 >>> sheet = wb.get_sheet_by_name('Sheet1')
 >>> sheet.get_highest_row()
 7
 >>> sheet.get_highest_column()
 3
 请注意，get_highest_column()方法返回一个整数，而不是 Excel 中出现的字母。
```



#### 列字母和数字之间的转换

要从字母转换到数字，就调用 openpyxl.cell.column_index_from_string()函数

要从数字转换到字母，就调用 openpyxl.cell.get_column_letter()函数。

```
>>> import openpyxl
 >>> from openpyxl.cell import get_column_letter, column_index_from_string
 >>> get_column_letter(1)
 'A'
 >>> get_column_letter(2)
 'B'
 >>> get_column_letter(27)
 'AA'
 >>> get_column_letter(900)
 'AHP'
 >>> wb = openpyxl.load_workbook('example.xlsx')
 >>> sheet = wb.get_sheet_by_name('Sheet1')
 >>> get_column_letter(sheet.get_highest_column())
 'C'
 >>> column_index_from_string('A')
 1
 >>> column_index_from_string('AA')
 27
```

#### 从表中取得行和列

可以将 Worksheet 对象切片，取得电子表格中一行、一列或一个矩形区域中的所有
 Cell 对象。然后可以循环遍历这个切片中的所有单元格。

```python
>>> import openpyxl
 >>> wb = openpyxl.load_workbook('example.xlsx')
 >>> sheet = wb.get_sheet_by_name('Sheet1')
 >>> tuple(sheet['A1':'C3'])
 ((<Cell Sheet1.A1>, <Cell Sheet1.B1>, <Cell Sheet1.C1>), (<Cell Sheet1.A2>,
 <Cell Sheet1.B2>, <Cell Sheet1.C2>), (<Cell Sheet1.A3>, <Cell Sheet1.B3>,
 <Cell Sheet1.C3>))
  >>> for rowOfCellObjects in sheet['A1':'C3']:
  for cellObj in rowOfCellObjects:
 print(cellObj.coordinate, cellObj.value)
 print('--- END OF ROW ---')
    
    
    >>> import openpyxl
 >>> wb = openpyxl.load_workbook('example.xlsx')
 >>> sheet = wb.get_active_sheet()
 >>> sheet.columns[1]
 (<Cell Sheet1.B1>, <Cell Sheet1.B2>, <Cell Sheet1.B3>, <Cell Sheet1.B4>,
 <Cell Sheet1.B5>, <Cell Sheet1.B6>, <Cell Sheet1.B7>)
 >>> for cellObj in sheet.columns[1]:
 print(cellObj.value)
   Apples
 Cherries
 Pears
 Oranges
 Apples
 Bananas
 Strawberries 
    
    
    
1．导入 openpyxl 模块。
 2．调用 openpyxl.load_workbook()函数。
 3．取得 Workbook 对象。
 4．调用 get_active_sheet()或 get_sheet_by_name()工作簿方法。
 5．取得 Worksheet 对象。
 6．使用索引或工作表的 cell()方法，带上 row 和 column 关键字参数。
 7．取得 Cell 对象。
 8．读取 Cell 对象的 value 属性。
 
 
```



#### 12.5.1 创建并保存 Excel 文档

```
>>> import openpyxl
 >>> wb = openpyxl.Workbook()
 >>> wb.get_sheet_names()
 ['Sheet']
 >>> sheet = wb.get_active_sheet()
 >>> sheet.title
 
 'Sheet'
 >>> sheet.title = 'Spam Bacon Eggs Sheet'
 >>> wb.get_sheet_names()
 ['Spam Bacon Eggs Sheet']
 
 
 
 将文件名作为字符串传递给 save()方法。
 >>> import openpyxl
 >>> wb = openpyxl.load_workbook('example.xlsx')
 >>> sheet = wb.get_active_sheet()
 >>> sheet.title = 'Spam Spam Spam'
 >>> wb.save('example_copy.xlsx')
 
 
 
```

#### 创建和删除工作表

 **create_sheet() and remove_sheet()方法，可以在工作簿中添加或删除工作表。**

```python
>>> import openpyxl
 >>> wb = openpyxl.Workbook()
 >>> wb.get_sheet_names()
 ['Sheet']
 >>> wb.create_sheet()
 <Worksheet "Sheet1">
 >>> wb.get_sheet_names()
 ['Sheet', 'Sheet1']
 >>> wb.create_sheet(index=0, title='First Sheet')
 <Worksheet "First Sheet">
 >>> wb.get_sheet_names()
 ['First Sheet', 'Sheet', 'Sheet1']
 >>> wb.create_sheet(index=2, title='Middle Sheet')
 <Worksheet "Middle Sheet">
 >>> wb.get_sheet_names()
 ['First Sheet', 'Sheet', 'Middle Sheet', 'Sheet1']


>>> wb.get_sheet_names()
 ['First Sheet', 'Sheet', 'Middle Sheet', 'Sheet1']
 >>> wb.remove_sheet(wb.get_sheet_by_name('Middle Sheet'))
 >>> wb.remove_sheet(wb.get_sheet_by_name('Sheet1'))
 >>> wb.get_sheet_names()
 ['First Sheet', 'Sheet']
    

```

#### 将值写入单元格 

```
>>> import openpyxl
 >>> wb = openpyxl.Workbook()
 >>> sheet = wb.get_sheet_by_name('Sheet')
 >>> sheet['A1'] = 'Hello world!'
 >>> sheet['A1'].value
 'Hello world!'
```



## 第 13 章 处理 PDF 和 Word 文档

#### 从 PDF 提取文本 

```
 import PyPDF2

>>> import PyPDF2
 >>> pdfFileObj = open('meetingminutes.pdf', 'rb')
 >>> pdfReader = PyPDF2.PdfFileReader(pdfFileObj)
  >>> pdfReader.numPages
 19
  >>> pageObj = pdfReader.getPage(0)
  >>> pageObj.extractText()
 'OOFFFFIICCIIAALL BBOOAARRDD MMIINNUUTTEESS Meeting of March 7, 2015
\n The Board of Elementary and Secondary Education shall provide leadership
 and create policies for education that expand opportunities for children,
 empower families and communities, and advance Louisiana in an increasingly
 competitive global market. BOARD of ELEMENTARY and SECONDARY EDUCATION '

```

#### 解密 PDF

```
要读取加密的 PDF，就调用 decrypt()函数，



>>> import PyPDF2
 >>> pdfReader = PyPDF2.PdfFileReader(open('encrypted.pdf', 'rb'))
  >>> pdfReader.isEncrypted
 True
 >>> pdfReader.getPage(0)
  Traceback (most recent call last):
 File "<pyshell#173>", line 1, in <module>
 pdfReader.getPage()
 --snip--
 File "C:\Python34\lib\site-packages\PyPDF2\pdf.py", line 1173, in getObject
 raise utils.PdfReadError("file has not been decrypted")
 PyPDF2.utils.PdfReadError: file has not been decrypted
  >>> pdfReader.decrypt('rosebud')
 1 >>> pageObj = pdfReader.getPage(0)
```

#### 创建 PDF

```

 在 PyPDF2 中，与 PdfFileReader 对象相对的是 PdfFileWriter 对象，它可以创建
 一个新的 PDF 文件。
 
 
 模块不允许直接编辑 PDF。必须创建一个新的 PDF，然后从已有的文档拷贝内 容。本节的例子将遵循这种一般方式：
 1．打开一个或多个已有的 PDF（源 PDF），得到 PdfFileReader 对象。
 2．创建一个新的 PdfFileWriter 对象。
 3．将页面从 PdfFileReader 对象拷贝到 PdfFileWriter 对象中。
 4．最后，利用 PdfFileWriter 对象写入输出的 PDF。
 
 
 
```

#### 拷贝页面

```
可以利用 PyPDF2，从一个 PDF 文档拷贝页面到另一个 PDF 文档。这让你能够
 组合多个 PDF 文件，去除不想要的页面，或调整页面的次序。
 
 >>> import PyPDF2
 >>> pdf1File = open('meetingminutes.pdf', 'rb')
 >>> pdf2File = open('meetingminutes2.pdf', 'rb')
  >>> pdf1Reader = PyPDF2.PdfFileReader(pdf1File)
  >>> pdf2Reader = PyPDF2.PdfFileReader(pdf2File)
  >>> pdfWriter = PyPDF2.PdfFileWriter()
 >>> for pageNum in range(pdf1Reader.numPages):
  pageObj = pdf1Reader.getPage(pageNum)
  pdfWriter.addPage(pageObj)
 >>> for pageNum in range(pdf2Reader.numPages):
  pageObj = pdf2Reader.getPage(pageNum)
  pdfWriter.addPage(pageObj)
  >>> pdfOutputFile = open('combinedminutes.pdf', 'wb')
 >>> pdfWriter.write(pdfOutputFile)
 >>> pdfOutputFile.close()
 >>> pdf1File.close()
 >>> pdf2File.close()
  
 
```

#### 旋转页面

```
利用 rotateClockwise()和 rotateCounterClockwise()方法，PDF 文档的页面也可以
 旋转 90 度的整数倍。向这些方法传入整数 90、180 或 270 就可以了。
 
 >>> import PyPDF2
 >>> minutesFile = open('meetingminutes.pdf', 'rb')
 >>> pdfReader = PyPDF2.PdfFileReader(minutesFile)
  >>> page = pdfReader.getPage(0)
  >>> page.rotateClockwise(90)
 {'/Contents': [IndirectObject(961, 0), IndirectObject(962, 0),
 --snip--
 } >>> pdfWriter = PyPDF2.PdfFileWriter()
 >>> pdfWriter.addPage(page)
 
 >>> resultPdfFile = open('rotatedPage.pdf', 'wb')
 >>> pdfWriter.write(resultPdfFile)
 >>> resultPdfFile.close()
 >>> minutesFile.close()
 
```

#### 叠加页面

```
PyPDF2 也可以将一页的内容叠加到另一页上，这可以用来在页面上添加公司标志、时间戳或水印
 
 >>> import PyPDF2
 >>> minutesFile = open('meetingminutes.pdf', 'rb')
  >>> pdfReader = PyPDF2.PdfFileReader(minutesFile)
  >>> minutesFirstPage = pdfReader.getPage(0)
  >>> pdfWatermarkReader = PyPDF2.PdfFileReader(open('watermark.pdf', 'rb'))>>> minutesFirstPage.mergePage(pdfWatermarkReader.getPage(0))
  >>> pdfWriter = PyPDF2.PdfFileWriter()
  >>> pdfWriter.addPage(minutesFirstPage)
  >>> for pageNum in range(1, pdfReader.numPages):
 pageObj = pdfReader.getPage(pageNum)
 pdfWriter.addPage(pageObj)
 >>> resultPdfFile = open('watermarkedCover.pdf', 'wb')
 >>> pdfWriter.write(resultPdfFile)
 >>> minutesFile.close()
 >>> resultPdfFile.close()
 
 >>> minutesFirstPage.mergePage(pdfWatermarkReader.getPage(0))
  >>> pdfWriter = PyPDF2.PdfFileWriter()
  >>> pdfWriter.addPage(minutesFirstPage)
  >>> for pageNum in range(1, pdfReader.numPages):
 pageObj = pdfReader.getPage(pageNum)
 pdfWriter.addPage(pageObj)
 >>> resultPdfFile = open('watermarkedCover.pdf', 'wb')
 >>> pdfWriter.write(resultPdfFile)
 >>> minutesFile.close()
 >>> resultPdfFile.close()
 
 这里我们生成了 meetingminutes.pdf 的 PdfFileReader 对象。
 调用 getPage(0)， 取得第一页的Page 对象，并将它保存在 minutesFirstPage 中
 。然后生成了 watermark.pd 
 的PdfFileReader 对象
 ，并在minutesFirstPage 上调用mergePage()
 。传递给mergePage()
 的参数，是 watermark.pdf 第一页的 Page 对象。
 既然我们已经在 minutesFirstPage 上调用了 mergePage()，minutesFirstPage 就代
 表加了水印的第一页。我们创建一个 PdfFileWriter 对象
 ，并加入加了水印的第一页
 。 然后循环遍历 meetingminutes.pdf 的剩余页面，将它们添加到 PdfFileWriter 对象中
 。 最后，我们打开一个新的 PDF 文件 watermarkedCover.pdf，并将 PdfFileWriter 的内容写
 入该文件。
 
```

#### 加密 PDF

```
>>> import PyPDF2
 >>> pdfFile = open('meetingminutes.pdf', 'rb')
 >>> pdfReader = PyPDF2.PdfFileReader(pdfFile)
 >>> pdfWriter = PyPDF2.PdfFileWriter()
 >>> for pageNum in range(pdfReader.numPages):
 pdfWriter.addPage(pdfReader.getPage(pageNum))
  >>> pdfWriter.encrypt('swordfish')
 >>> resultPdf = open('encryptedminutes.pdf', 'wb')
 >>> pdfWriter.write(resultPdf)
 >>> resultPdf.close()
 
 调用 encrypt()方法，传入口令字符串
 在这个例子中，我们将 meetingminutes.pdf 的页面拷贝到 PdfFileWriter 对象。用口
 令 swordfish 加密了 PdfFileWriter，打开了一个名为 encryptedminutes.pdf 的新 PDF，将
 PdfFileWriter 的内容写入新 PDF。任何人要查看 encryptedminutes.pdf，都必须输入这个
 口令。在确保文件的拷贝被正确加密后，你可能会删除原来的未加密的文件。
```

####  项目：从多个 PDF 中合并选择的页面

总的来说，该程序需要完成：
  找到当前工作目录中所有 PDF 文件。
  按文件名排序，这样就能有序地添加这些 PDF。  除了第一页之外，将每个 PDF 的所有页面写入输出的文件。
 从实现的角度来看，代码需要完成下列任务：
  调用 os.listdir()，找到当前工作目录中的所有文件，去除掉非 PDF 文件。
  调用 Python 的 sort()列表方法，对文件名按字母排序。
  为输出的 PDF 文件创建 PdfFileWriter 对象。
  循环遍历每个 PDF 文件，为它创建 PdfFileReader 对象。
  针对每个 PDF 文件，循环遍历每一页，第一页除外。
  将页面添加到输出的 PDF。  将输出的 PDF 写入一个文件，名为 allminutes.pdf。 针对这个项目，打开一个新的文件编辑器窗口，将它保存为 combinePdfs.py。

## Word 文档

**pip install python-docx**

**import docx**

#### 读取 Word 文档

```
>>> import docx
  >>> doc = docx.Document('demo.docx')#在 Python 中打开了一个.docx 文件，
  >>> len(doc.paragraphs)#将返回 7。这告诉我们，该文档有 7 个 Paragraph 对象
 7
  >>> doc.paragraphs[0].text#每个 Paragraph 对象都有一个 text 属性，包含该段中文本
 的字符串（没有样式信息）。这里，第一个 text 属性包含'DocumentTitle
 'Document Title'
  >>> doc.paragraphs[1].text，#第二个包含'A plain paragraph with some bold and some italic'
 'A plain paragraph with some bold and some italic'
  >>> len(doc.paragraphs[1].runs)# 返回4，含义是有4个run对象
 4
  >>> doc.paragraphs[1].runs[0].text
 'A plain paragraph with some '
  >>> doc.paragraphs[1].runs[1].text
 'bold'
  >>> doc.paragraphs[1].runs[2].text
 ' and some '
 第一个对象包含'A plain paragraph with some '。然
 后，文本变为粗体样式，所以’bold’开始了一个新的 Run 对象。在这之后，文本
 又回到了非粗体的样式，这导致了第三个 Run 对象，' and some
 
  >>> doc.paragraphs[1].runs[3].text。#最后，第四个对象包含'italic'，是斜体样式
 'italic'
```

#### 从.docx 文件中取得完整的文本

如果你只关心 Word 文档中的文本，不关心样式信息，就可以利用 getText()函 数

```python
#! python3
 import docx
    
 def getText(filename):
     doc = docx.Document(filename)
     fullText = []
     for para in doc.paragraphs:
     	fullText.append(para.text)
     return '\n'.join(fullText)

getText()函数打开了 Word 文档，循环遍历 paragraphs 列表中的所有 Paragraph
 对象，然后将它们的文本添加到 fullText 列表中。循环结束后，fullText 中的字符串
 连接在一起，中间以换行符分隔。

readDocx.py 程序可以像其他模块一样导入。现在如果你只需要 Word 文档中的
 文本
>>> import readDocx
 >>> print(readDocx.getText('demo.docx'))
    
    
    
    
 也可以调整 getText()，在返回字符串之前进行修改。例如，要让每一段缩进，
 就将文件中的 append()调用替换为：
 fullText.append(' ' + para.text)
 要在段落之间增加空行，就将 join()调用代码改成：
 return '\n\n'.join(fullText)
 可以看到，只需要几行代码，就可以写出函数，读取.docx 文件，根据需要返
 回它的内容字符串。   
```

#### 设置 Paragraph 和 Run 对象的样式



#### 创建带有非默认样式的 Word 文档



#### Run 属性



#### 写入 Word 文档

```python
>>> import docx
 >>> doc = docx.Document()
 >>> doc.add_paragraph('Hello world!')
 <docx.text.Paragraph object at 0x0000000003B56F60>
 >>> doc.save('helloworld.docx')
 
 
 要创建自己的.docx 文件，就调用 docx.Document()，返回一个新的、空白的 Word 
 Document 对象。Document 对象的 add_paragraph()方法将一段新文本添加到文档中，
 并返回添加的 Paragraph 对象的引用。在添加完文本之后，向 Document 对象的 save()
 方法传入一个文件名字符串，将 Document 对象保存到文件。


import docx
 >>> doc = docx.Document()
 >>> doc.add_paragraph('Hello world!')
 <docx.text.Paragraph object at 0x000000000366AD30>
 >>> paraObj1 = doc.add_paragraph('This is a second paragraph.')
 >>> paraObj2 = doc.add_paragraph('This is a yet another paragraph.')
 >>> paraObj1.add_run(' This text is being added to the second paragraph.')
 <docx.text.Run object at 0x0000000003A2C860>
 >>> doc.save('multipleParagraphs.docx')


```



#### 添加标题

调用 add_heading()将添加一个段落，并使用一种标题样式。

```
>>> doc = docx.Document()
 >>> doc.add_heading('Header 0', 0)
 <docx.text.Paragraph object at 0x00000000036CB3C8>
 >>> doc.add_heading('Header 1', 1)
 <docx.text.Paragraph object at 0x00000000036CB630>
 >>> doc.add_heading('Header 2', 2)
 <docx.text.Paragraph object at 0x00000000036CB828>
 >>> doc.add_heading('Header 3', 3)
 <docx.text.Paragraph object at 0x00000000036CB2E8>
 >>> doc.add_heading('Header 4', 4)
 <docx.text.Paragraph object at 0x00000000036CB3C8>
 >>> doc.save('headings.docx')
 
 
 
```

#### 添加换行符和换页符

add_break（） 换行符

doc.paragraphs[0].runs[0].add_break(docx.text.WD_BREAK.PAGE) 换页符

```
>>> doc = docx.Document()
 >>> doc.add_paragraph('This is on the first page!')
 <docx.text.Paragraph object at 0x0000000003785518>
  >>> doc.paragraphs[0].runs[0].add_break(docx.text.WD_BREAK.PAGE)
 >>> doc.add_paragraph('This is on the second page!')
 <docx.text.Paragraph object at 0x00000000037855F8>
 >>> doc.save('twoPage.docx')
```

#### 添加图像

add_picture()方法，让你在文档末尾添加图像

```
>>> doc.add_picture('zophie.png', width=docx.shared.Inches(1),height=docx.shared.Cm(4))
 
 <docx.shape.InlineShape object at 0x00000000036C7D30>
 宽度为 1 英寸，高度为 4 厘米（Word 可以同时使用英制和公制单位）：
```









## 第 14  章  处理 CSV 文件和 JSON 数据

#### 1 csv 模块

CSV 文件是简单的，缺少 Excel 电子表格的许多功能。例如，CSV 文件中：
 • 值没有类型，所有东西都是字符串；
 • 没有字体大小或颜色的设置；
 • 没有多个工作表；
 • 不能指定单元格的宽度和高度；
 • 不能合并单元格；
 • 不能嵌入图像或图表

##### Reader 对象

```
 >>> import csv
  >>> exampleFile = open('example.csv')
  >>> exampleReader = csv.reader(exampleFile)
  >>> exampleData = list(exampleReader)
  >>> exampleData
 [['4/5/2015 13:34', 'Apples', '73'], ['4/5/2015 3:41', 'Cherries', '85'],
 ['4/6/2015 12:46', 'Pears', '14'], ['4/8/2015 8:59', 'Oranges', '52'],
 ['4/10/2015 2:07', 'Apples', '152'], ['4/10/2015 18:10', 'Bananas', '23'],
 ['4/10/2015 2:40', 'Strawberries', '98']]
 >>> exampleData[0][0]
 '4/5/2015 13:34'
 >>> exampleData[0][1]
 'Apples'
 >>> exampleData[0][2]
 '73'
 >>> exampleData[1][1]
 'Cherries'
 >>> exampleData[6][1]
 'Strawberries
```

##### 2 在 for 循环中，从 Reader 对象读取数据

```python
>>> import csv
 >>> exampleFile = open('example.csv')
 >>> exampleReader = csv.reader(exampleFile)
 >>> for row in exampleReader:
	 print('Row #' + str(exampleReader.line_num) + ' ' + str(row))

Row #1 ['4/5/2015 13:34', 'Apples', '73']
 Row #2 ['4/5/2015 3:41', 'Cherries', '85']
 Row #3 ['4/6/2015 12:46', 'Pears', '14']
 Row #4 ['4/8/2015 8:59', 'Oranges', '52']
 Row #5 ['4/10/2015 2:07', 'Apples', '152']
 Row #6 ['4/10/2015 18:10', 'Bananas', '23']
 Row #7 ['4/10/2015 2:40', 'Strawberries', '98']

line_num 变量，它包含了当前行的编号。
Reader 对象只能循环遍历一次。要再次读取 CSV 文件，必须调用 csv.reader，创
 建一个对象。
```

#### Writer 对象

Writer 对象让你将数据写入 CSV 文件。要创建一个 Writer 对象，就使用 csv.writer()函数。

```python
>>> import csv
  >>> outputFile = open('output.csv', 'w', newline='')
  >>> outputWriter = csv.writer(outputFile)
 >>> outputWriter.writerow(['spam', 'eggs', 'bacon', 'ham'])
 21
 >>> outputWriter.writerow(['Hello, world!', 'eggs', 'bacon', 'ham'])
 32
 >>> outputWriter.writerow([1, 2, 3.141592, 4])
 16
 >>> outputFile.close()
 
首先，调用 open()并传入'w'，以写模式打开一个文件。这将创建对象。然后
 将它传递给 csv.writer()，创建一个 Writer 对象。
```



#### delimiter 和 lineterminator 关键字参数

分隔符、行终止符

```
>>> import csv
 >>> csvFile = open('example.tsv', 'w', newline='')
  >>> csvWriter = csv.writer(csvFile, delimiter='\t', lineterminator='\n\n')
 >>> csvWriter.writerow(['apples', 'oranges', 'grapes'])
 24
 >>> csvWriter.writerow(['eggs', 'bacon', 'ham'])
 17
 >>> csvWriter.writerow(['spam', 'spam', 'spam', 'spam', 'spam', 'spam'])
 32
 >>> csvFile.close()
 
 
 默认情况下，CSV 文件的分隔符是逗号
 你可以利用 csv.writer()的 delimiter 和 lineterminator关键字参数，将这些字符改成不同的值。
```

#### JSON 和 API

json 模块：Python 的 json 模块处理了 JSON 数据字符串和 Python 值之间转换的所有细节，
 得到了 json.loads()和 json.dumps()函数。J

#### 用 loads()函数读取 JSON-----转换为 Python 的值，

要将包含 JSON 数据的字符串转换为 Python 的值，

```python
>>> stringOfJsonData = '{"name": "Zophie", "isCat": true, "miceCaught": 0,
 "felineIQ": null}'
 >>> import json
 >>> jsonDataAsPythonValue = json.loads(stringOfJsonData)
 >>> jsonDataAsPythonValue
 {'isCat': True, 'miceCaught': 0, 'name': 'Zophie', 'felineIQ': None}
```

#### 用 dumps 函数写出 JSON

json.dumps()函数将一个 Python 值转换成 JSON 格式的数据字符串。

```python
>>> pythonValue = {'isCat': True, 'miceCaught': 0, 'name': 'Zophie',
 'felineIQ': None}
 >>> import json
 >>> stringOfJsonData = json.dumps(pythonValue)
 >>> stringOfJsonData
 '{"isCat": true, "felineIQ": null, "miceCaught": 0, "name": "Zophie" }'
```

## 第 15  章 保持时间、计划任务和启动程序

#### time 模块

其中，time.time()和 time.sleep()函数是 最有用的模块。

```
>>> import time
 >>> time.time()
 1425063955.068649
 
 
 import time
  def calcProd():
 # Calculate the product of the first 100,000 numbers.
 product = 1
 for i in range(1, 100000):
 product = product * i
 return product
  startTime = time.time()
 prod = calcProd()
  endTime = time.time()
  print('The result is %s digits long.' % (len(str(prod))))
  print('Took %s seconds to calculate.' % (endTime - startTime))
 
 
 
```

##### time.sleep()函数



#### 数字四舍五入

>>> import time
>>> now = time.time()
>>> now
>>>  1425064108.017826
>>> round(now, 2)
>>>  1425064108.02
>>> round(now, 4)
>>>  1425064108.0178
>>> round(now)
>>>  1425064108

如果省略第二个参数，round()将数字四舍五入到最接近的整数



#### datetime 模块

```python
>>> import datetime
  >>> datetime.datetime.now()
  datetime.datetime(2015, 2, 27, 11, 10, 49, 55, 53)
  >>> dt = datetime.datetime(2015, 10, 21, 16, 29, 0)
  >>> dt.year, dt.month, dt.day
 (2015, 10, 21)
  >>> dt.hour, dt.minute, dt.second
 (16, 29, 0)
    
    
    
    调用 datetime.datetime.now()返回一个 datetime 对象，表示当前的日期和时
 间，根据你的计算机的时钟。这个对象包含当前时刻的年、月、日、时、分、秒和
 微秒。也可以利用 datetime.datetime()函数，向它传入代表年、月、日、时、分、
 秒的整数，得到特定时刻的 datetime 对象。这些整数将保存在 datetime 对象的 year、 month、day、hour、minute 和 second属性中。


```

## timedelta 数据类型

```
 >>> delta = datetime.timedelta(days=11, hours=10, minutes=9, seconds=8)
  >>> delta.days, delta.seconds, delta.microseconds
 (11, 36548, 0)
 >>> delta.total_seconds()
 986948.0
 >>> str(delta)
 '11 days, 10:09:08'
```



#### 暂停直至特定日期

```
time.sleep()方法可以暂停程序若干秒。利用一个 while 循环，可以让程序暂停，
 直到一个特定的日期。例如，下面的代码会继续循环，直到 2016 年万圣节：
 import datetime
 import time
 halloween2016 = datetime.datetime(2016, 10, 31, 0, 0, 0)
 while datetime.datetime.now() < halloween2016:
 time.sleep(1)
```



#### 将 datetime 对象转换为字符串

```
表 15-1 strftime()指令
 strftime 指令  含义
 %Y  带世纪的年份，例如'2014'
 %y  不带世纪的年份，'00'至'99'（1970 至 2069） %m  数字表示的月份, '01'至'12'
 %B  完整的月份，例如'November'
 %b  简写的月份，例如'Nov'
 %d  一月中的第几天，'01'至'31'
 %j 一年中的第几天，'001'至'366'
 %w  一周中的第几天，'0'（周日）至'6'（周六）
 %A  完整的周几，例如'Monday'
 %a  简写的周几，例如'Mon'
 %H  小时（24 小时时钟），'00'至'23'
 %I  小时（12 小时时钟），'01'至'12'
 %M  分，'00'至'59'
 %S  秒，'00'至'59'
 %p  'AM'或'PM'
 %%  就是'%'字符
 
 >>> oct21st = datetime.datetime(2015, 10, 21, 16, 29, 0)
 >>> oct21st.strftime('%Y/%m/%d %H:%M:%S')
 '2015/10/21 16:29:00'
 >>> oct21st.strftime('%I:%M %p')
 '04:29 PM'
 >>> oct21st.strftime("%B of '%y")
 "October of '15"
 
 
 
```

#### 将字符串转换成 datetime 对象

```
datetime.datetime.strftime()函数


 >>> datetime.datetime.strptime('October 21, 2015', '%B %d, %Y')
 datetime.datetime(2015, 10, 21, 0, 0)
 >>> datetime.datetime.strptime('2015/10/21 16:29:00', '%Y/%m/%d %H:%M:%S')
 datetime.datetime(2015, 10, 21, 16, 29)
 >>> datetime.datetime.strptime("October of '15", "%B of '%y")
 datetime.datetime(2015, 10, 1, 0, 0)
 >>> datetime.datetime.strptime("November of '63", "%B of '%y")
 datetime.datetime(2063, 11, 1, 0, 0)


```

## 回顾 Python 的时间函数

程快速上手——让繁琐工作自动化
 在 Python 中，日期和时间可能涉及好几种不同的数据类型和函数。下面回顾了
 表示时间的 3 种不同类型的值：
  Unix 纪元时间戳（time 模块中使用）是一个浮点值或整型值，表示自 1970 年
 1 月 1 日午夜 0 点（UTC）以来的秒数。
  datetime 对象（属于 datetime 模块）包含一些整型值，保存在 year、month、day、 hour、minute 和 second 等属性中。
  timedelta 对象（属于 datetime 模块）表示的一段时间，而不是一个特定的时刻。
 下面回顾了时间函数及其参数和返回值：
  time.time()函数返回一个浮点值，表示当前时刻的 Unix 纪元时间戳。
  time.sleep(seconds)函数让程序暂停 seconds 参数指定的秒数。
  datetime.datetime(year, month, day, hour, minute, second)函数返回参数指定的时刻的 datetime 对象。如果没有提供 hour、minute 或 second 参数，它们默认为 0。

  datetime.datetime.now()函数返回当前时刻的 datetime 对象。
  datetime.datetime.fromtimestamp(epoch)函数返回 epoch 时间戳参数表示的时刻
 的 datetime 对象。
  datetime.timedelta(weeks, days, hours, minutes, seconds, milliseconds, microseconds)函 数返回一个表示一段时间的 timedelta 对象。该函数的关键字参数都是可选的，
 不包括 month 或 year。  total_seconds()方法用于 timedelta 对象，返回 timedelta 对象表示的秒数。
  strftime(format)方法返回一个字符串，用 format 字符串中的定制格式来表示
 datetime 对象表示的时间。详细格式参见表 15-1。  datetime.datetime.strptime(time_string, format)函数返回一个 datetime 对象，它的
 时刻由 time_string 指定，利用 format 字符串参数来解析。详细格式参见表 15-1。



## 多线程

```
import threading, time
 print('Start of program.')
  def takeANap():
 time.sleep(5)
 print('Wake up!')
  threadObj = threading.Thread(target=takeANap)
  threadObj.start()
 print('End of program.')
```





## 第16  章 发送电子邮件和短信





## 第17  章 操 作 图 像



pip install pillow

名称  RGBA 值  名称  RGBA 值
 White  (255, 255, 255, 255)  Red  (255, 0, 0, 255)
 Green  (0, 128, 0, 255)  Blue  (0, 0, 255, 255)
 Gray  (128, 128, 128, 255)  Yellow  (255, 255, 0, 255)
 Black  (0, 0, 0, 255)  Purple  (128, 0, 128, 255)

```python
 >>> from PIL import ImageColor
  >>> ImageColor.getcolor('red', 'RGBA')
 (255, 0, 0, 255)
  >>> ImageColor.getcolor('RED', 'RGBA')
 (255, 0, 0, 255)
 >>> ImageColor.getcolor('Black', 'RGBA')
 (0, 0, 0, 255)
 >>> ImageColor.getcolor('chocolate', 'RGBA')
 (210, 105, 30, 255)
 >>> ImageColor.getcolor('CornflowerBlue', 'RGBA')
 (100, 149, 237, 255)
 
 
 >>> from PIL import Image
 >>> catIm = Image.open('zophie.png')
 
 >>> import os
 >>> os.chdir('C:\\folder_with_image_file')
 
处理 Image 数据类型
>>> from PIL import Image
 >>> catIm = Image.open('zophie.png')
 >>> catIm.size
  (816, 1088)
  >>> width, height = catIm.size
  >>> width
 816
  >>> height
 1088
 >>> catIm.filename
 'zophie.png'
 >>> catIm.format
 'PNG'
 >>> catIm.format_description
 'Portable network graphics'
  >>> catIm.save('zophie.jpg')



>>> from PIL import Image
  >>> im = Image.new('RGBA', (100, 200), 'purple' 
 >>> im.save('purpleImage.png')
  >>> im2 = Image.new('RGBA', (20, 20))
 >>> im2.save('transparentImage.png')
 
 
 裁剪图片
                      
 >>> croppedIm = catIm.crop((335, 345, 565, 560))
 >>> croppedIm.save('cropped.png')                  
                      
                      
                      
 复制和粘贴图像到其他图像
 >>> catIm = Image.open('zophie.png')
 >>> catCopyIm = catIm.copy()
 
                      
  >>> faceIm = catIm.crop((335, 345, 565, 560))
 >>> faceIm.size
 (230, 215)
 >>> catCopyIm.paste(faceIm, (0, 0))
 >>> catCopyIm.paste(faceIm, (400, 500))
 >>> catCopyIm.save('pasted.png')
                      
                      
>>> catImWidth, catImHeight = catIm.size
 >>> faceImWidth, faceImHeight = faceIm.size
  >>> catCopyTwo = catIm.copy()
  >>> for left in range(0, catImWidth, faceImWidth):
  for top in range(0, catImHeight, faceImHeight):
 print(left, top)
 catCopyTwo.paste(faceIm, (left, top))
 0 0
 0 215
 0 430
 0 645
 0 860
0 1075
 230 0
 230 215
 --snip--
 690 860
 690 1075
 >>> catCopyTwo.save('tiled.png')
                      
 调整图像大小
  >>> width, height = catIm.size
  >>> quartersizedIm = catIm.resize((int(width / 2), int(height / 2)))
 >>> quartersizedIm.save('quartersized.png')
  >>> svelteIm = catIm.resize((width, height + 300))
 >>> svelteIm.save('svelte.png')
 
 旋转和翻转图像
 >>> catIm.rotate(90).save('rotated90.png')
 >>> catIm.rotate(180).save('rotated180.png')
 >>> catIm.rotate(270).save('rotated270.png')
 
 
在图像上绘画 
 >>> from PIL import Image, ImageDraw
 >>> im = Image.new('RGBA', (200, 200), 'white')
 >>> draw = ImageDraw.Draw(im)
点 
 point(xy, fill)方法绘制单个像素                      
线 
 line(xy, fill, width)方法绘制一条线或一系列的线。                    矩形
 rectangle(xy, fill, outline)方法绘制一个矩形。  
  椭圆
 ellipse(xy, fill, outline)方法绘制一个椭圆。                    
   多边形
 polygon(xy, fill, outline)方法绘制任意的多边形。                   
                      
                      
                      
                      
                      
                      
```



## 第  18 章 用 GUI 自动化控制键盘和鼠标



安装 pyautogui 模块

pip install pyautogui



```
 程序失去控制时如何终止程序
 在 Windows 和 Linux 上，注销的热键是 Ctrl-Alt-Del。
>> import pyautogui
>>> pyautogui.PAUSE = 1
>>> pyautogui.FAILSAFE = True
将 pyautogui.PAUSE 设置为 1，即每次函数调用后暂停一秒。将 pyautogui.FAILSAFE 设置为 True，启动自动防故障功能。

 控制鼠标移动
>>> import pyautogui
>>> pyautogui.size()
(1920, 1080)
>>> width, height = pyautogui.size()


pyautogui.moveTo() 函数将鼠标立即移动到屏幕的指定位置。表示 x、y 坐标的整数值分别构成了函数的第一个和第二个参数。
可选的 duration 整数或浮点数关键字参数，指定了将鼠标移到目的位置所需的秒数。如果不指定，默认值是零，表示立即移动:
>>> import pyautogui
>>> for i in range(10):
 pyautogui.moveTo(100, 100, duration=0.25)
 pyautogui.moveTo(200, 100, duration=0.25)
 pyautogui.moveTo(200, 200, duration=0.25)
 pyautogui.moveTo(100, 200, duration=0.25)


pyautogui.moveRel() 函数相对于当前的位置移动鼠标。下面的例子以正方形的模式移动鼠标，只是它从鼠标当前所在的位置开始，按正方形移动：
>>> import pyautogui
>>> for i in range(10):
 pyautogui.moveRel(100, 0, duration=0.25)
 pyautogui.moveRel(0, 100, duration=0.25)
 pyautogui.moveRel(-100, 0, duration=0.25)
 pyautogui.moveRel(0, -100, duration=0.25)


通过调用 pyautogui.position() 函数，可以确定鼠标当前的位置
>>> pyautogui.position()
(311, 622)
>>> pyautogui.position()
(377, 481)
>>> pyautogui.position()
(1536, 637)


点击鼠标
>>> import pyautogui
>>> pyautogui.click(10, 5)
如果想指定鼠标按键，就加入 button 关键字参数，值分别为 'left'、'middle'或 'right'。
例如，pyautogui.click（100，150，button='left'）将在坐标（100，150）处点击鼠标左键。
而 pyautogui.click（200，250，button='right'）将在坐标（200，250）处点击右键。

拖动鼠标
import pyautogui, time
time.sleep(5)
pyautogui.click() # click to put drawing program in focus
distance = 200
while distance > 0:
	pyautogui.dragRel(distance, 0, duration=0.2) # move right 
	distance = distance - 5 
	pyautogui.dragRel(0, distance, duration=0.2) # move down 
	pyautogui.dragRel(-distance, 0, duration=0.2) # move left 
	distance = distance - 5 
	pyautogui.dragRel(0, -distance, duration=0.2) # move up 


举例：请打开 Windows 上的画图软件，让鼠标停留在绘图应用的画布上，同时选中铅笔或画笔工具，在新的文件编辑窗口中输入以下内容，保存为 spiralDraw.py：

import pyautogui, time
time.sleep(5)
pyautogui.click() # click to put drawing program in focus
distance = 200
while distance > 0:
	pyautogui.dragRel(distance, 0, duration=0.2) # move right 
	distance = distance - 5 
	pyautogui.dragRel(0, distance, duration=0.2) # move down 
	pyautogui.dragRel(-distance, 0, duration=0.2) # move left 
	distance = distance - 5 
	pyautogui.dragRel(0, -distance, duration=0.2) # move up 

滚动鼠标
>>> pyautogui.scroll(200)
获取屏幕快照
要在 Python 中获取屏幕快照，就调用 pyautogui.screenshot() 函数：
>>> import pyautogui
>>> im = pyautogui.screenshot()


getpixel() 函数传入坐标元组，如（0，0）或（50，200），它将告诉你图像中这些坐标处的像素颜色。getpixel() 函数的返回值是一个 RGB 元组，包含 3 个整数，表示像素的红绿蓝值。
>>> im.getpixel((0, 0))
(176, 176, 175)
>>> im.getpixel((50, 200))
(130, 135, 144)

 分析屏幕快照
>>> import pyautogui
>>> im = pyautogui.screenshot()
>>> im.getpixel((50, 200))
(130, 135, 144)
>>> pyautogui.pixelMatchesColor(50, 200, (130, 135, 144))
True
>>> pyautogui.pixelMatchesColor(50, 200, (255, 135, 144))
False


6. 图像识别
>>> import pyautogui
>>> pyautogui.locateOnScreen('submit.png')
(643, 745, 70, 29)
locateOnScreen() 函数将返回图像所在处的坐标：

>>> pyautogui.locateOnScreen('submit.png')
(643, 745, 70, 29)
>>> pyautogui.center((643, 745, 70, 29))
(678, 759)
>>> pyautogui.click((678, 759))



控制键盘
typewrite() 函数调用将向窗口发送文本 Hello world!
>>> pyautogui.click(100, 100); pyautogui.typewrite('Hello world!', 0.25)
还可以向 typewrite() 函数传递这些键字符串的列表。例如，以下的调用表示按 a 键，然后是 b 键，然后是左箭头两次，最后是 X 和 Y 键：
>>> pyautogui.typewrite(['a', 'b', 'left', 'left', 'X', 'Y'])
按下和释放键盘
>>> pyautogui.keyDown('shift'); pyautogui.press('4'); pyautogui.keyUp('shift')

热键组合
拷贝选择内容的常用热键是 Ctrl-C，用户按住Ctrl键，然后按C键，然后释放C和Ctrl键。要用pyautogui的keyDown() 和keyUp() 函数来做到这一点，必须输入以下代码
pyautogui.keyDown('ctrl')
pyautogui.keyDown('c')
pyautogui.keyUp('c')
pyautogui.keyUp('ctrl')

可以使用 pyautogui.hotkey() 函数，它接受多个键字符串参数，按顺序按下，再按相反的顺序释放
pyautogui.hotkey('ctrl', 'c')


PyAutoGUI函数用法举例
>>> import pyautogui

>>> screenWidth, screenHeight = pyautogui.size() # Get the size of the primary monitor.
>>> screenWidth, screenHeight
(2560, 1440)

>>> currentMouseX, currentMouseY = pyautogui.position() # Get the XY position of the mouse.
>>> currentMouseX, currentMouseY
(1314, 345)

>>> pyautogui.moveTo(100, 150) # Move the mouse to XY coordinates.

>>> pyautogui.click()          # Click the mouse.
>>> pyautogui.click(100, 200)  # Move the mouse to XY coordinates and click it.
>>> pyautogui.click('button.png') # Find where button.png appears on the screen and click it.

>>> pyautogui.move(400, 0)      # Move the mouse 400 pixels to the right of its current position.
>>> pyautogui.doubleClick()     # Double click the mouse.
>>> pyautogui.moveTo(500, 500, duration=2, tween=pyautogui.easeInOutQuad)  # Use tweening/easing function to move mouse over 2 seconds.

>>> pyautogui.write('Hello world!', interval=0.25)  # type with quarter-second pause in between each key
>>> pyautogui.press('esc')     # Press the Esc key. All key names are in pyautogui.KEY_NAMES

>>> with pyautogui.hold('shift'):  # Press the Shift key down and hold it.
        pyautogui.press(['left', 'left', 'left', 'left'])  # Press the left arrow key 4 times.
>>> # Shift key is released automatically.

>>> pyautogui.hotkey('ctrl', 'c') # Press the Ctrl-C hotkey combination.

>>> pyautogui.alert('This is the message to display.') # Make an alert box appear and pause the program until OK is clicked.





```

![在这里插入图片描述](D:\hgx笔记\hgxbijiben\4、爬虫知识\0f6bcc0183394f788d7c32c1746d36ff.png)