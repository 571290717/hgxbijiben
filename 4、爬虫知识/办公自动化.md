# 办公自动化



## 9、组 织 文 件 

### shutil 模块

import shutil

复制文件和文件夹

shutil.copy(source, destination)，将路径 source 处的文件复制到路径 destination

处的文件夹（source 和 destination 都是字符串）。

该函数返回一个字符串，表示被复制文件的路径。

 >>> ```
 >>> shutil.copy('C:\\spam.txt', 'C:\\delicious')
 >>>  'C:\\delicious\\spam.txt'
 >>> 
 >>> 
 >>> 
 >>> import shutil, os
 >>> 
 >>>  >>> os.chdir('C:\\')
 >>>  >>> shutil.copytree('C:\\bacon', 'C:\\bacon_backup')
 >>>  >>>  'C:\\bacon_backup
 >>> ```

shutil.copytree()调用创建了一个新文件夹，名为 bacon_backup，其中的内容与
 原来的 bacon 文件夹一样。现在你已经备份了非常非常宝贵的“bacon”。



### 文件和文件夹的移动与改名 

shutil.move(source, destination)

source 处的文件夹移动到路径destination，并返回新位置的绝对路径的字符串。



### 永久删除文件和文件夹 

 用 os.unlink(path)将删除 path 处的文件。

• 调用 os.rmdir(path)将删除 path 处的文件夹。该文件夹必须为空，其中没有任

何文件和文件夹。

• 调用 shutil.rmtree(path)将删除 path 处的文件夹，它包含的所有文件和文件夹都

会被删除。



### send2trash 模块安全地删除

shutil.rmtree()函数不可恢复地删除文件和文件夹

pip install send2trash，

利用 send2trash，比 Python 常规的删除函数要安全得多，因为它会将文件夹和文件发送到计算机的垃圾箱或回收站，而不是永久删除它们

```python
>>> import send2trash
>>> baconFile = open('bacon.txt', 'a') # creates the file
>>> baconFile.write('Bacon is not a vegetable.')
25
>>> baconFile.close()
>>> send2trash.send2trash('bacon.txt')
```



### 遍历目录树

os.walk()函数：

```
import os
for folderName, subfolders, filenames in os.walk('C:\\delicious'):
	print('The current folder is ' + folderName)
    for subfolder in subfolders:
        print('SUBFOLDER OF ' + folderName + ': ' + subfolder)
    for filename in filenames:
        print('FILE INSIDE ' + folderName + ': '+ filename)
    print('')



```

os.walk()函数被传入一个字符串值，即一个文件夹的路径。

os.walk()在循环的每次迭代中，返回 3 个值:

​	1．当前文件夹名称的字符串。

2．当前文件夹中子文件夹的字符串的列表。

3．当前文件夹中文件的字符串的列表。

foldername、subfolders 和 filenames。

### 用 zipfile 模块压缩文件

利用 zipfile 模块中的函数，Python 程序可以创建和打开（或解压）ZIP 文件。
 假定你有一个名为 example.zip 的 zip 文件

#### 读取 ZIP 文件

。要创建一个 ZipFile对象，

就调用 zipfile.ZipFile()函数，向它传入一个字符串，表示.zip 文件的文件名。

，zipfile 是 Python 模块的名称，ZipFile()是函数的名称



```python
>>> import zipfile, os
>>> os.chdir('C:\\') # move to the folder with example.zip
>>> exampleZip = zipfile.ZipFile('example.zip')
>>> exampleZip.namelist()
['spam.txt', 'cats/', 'cats/catnames.txt', 'cats/zophie.jpg']
>>> spamInfo = exampleZip.getinfo('spam.txt')
>>> spamInfo.file_size
13908
>>> spamInfo.compress_size
3828

表示字节数的 file_size和 compress_size，它们分别表示原来文件大小和压缩后文件大小
cpmpress  压紧
英[kəmˈpres , ˈkɒmpres]
美[kəmˈpres , ˈkɑːmpres]
v.	(被)压紧; 精简; 浓缩; 压缩(文件等);
n.	(止血、减痛等的)敷布，压布;

 >>> 'Compressed file is %sx smaller!' % (round(spamInfo.file_size / spamInfo
.compress_size, 2))
'Compressed file is 3.63x smaller!'
>>> exampleZip.close()
```

表示字节数的 file_size和 compress_size，它们分别表示原来文件大小和压缩后文件大小

#### 从 ZIP 文件中解压缩



ZipFile 对象的 extractall()方法从 ZIP 文件中解压缩所有文件和文件夹，放到当
 前工作目录中。

```
>>> import zipfile, os
 >>> os.chdir('C:\\') # move to the folder with example.zip
 >>> exampleZip = zipfile.ZipFile('example.zip')
  >>> exampleZip.extractall()
 >>> exampleZip.close()
 
 example.zip 的内容将被解压缩到 C:\。或者，你可以向
 extractall()传递的一个文件夹名称，它将文件解压缩到那个文件夹，而不是当前工作
 目录。如果传递给 extractall()方法的文件夹不存在，它会被创建。
 例如，如果你用
 exampleZip.extractall('C:\\ delicious')取代处的调用，代码就会从 example.zip 中解压
 缩文件，放到新创建的 C:\delicious 文件夹中。
 ZipFile 对象的 extract()方法从 ZIP 文件中解
 例如，如果你用
 exampleZip.extractall('C:\\ delicious')取代处的调用，代码就会从 example.zip 中解压
 缩文件，放到新创建的 C:\delicious 文件夹中。
 
 
 ZipFile 对象的 extract()方法从 ZIP 文件中解压缩单个文件。
 
 exampleZip.extract('spam.txt')
 'C:\\spam.txt'
 >>> exampleZip.extract('spam.txt', 'C:\\some\\new\\folders')
 'C:\\some\\new\\folders\\spam.txt'
 >>> exampleZip.close()


。extract()
 的返回值是被压缩后文件的绝对路径。 
```



import zipfile,os

os.chdir('c:\\')

exampleZip = ZipFile.ZipFile

exampleZip.extractall()#全解压



#### 创建和添加到 ZIP 文件



```
>>> import zipfile
 >>> newZip = zipfile.ZipFile('new.zip', 'w')
 >>> newZip.write('spam.txt', compress_type=zipfile.ZIP_DEFLATED)
 >>> newZip.close()
 
 
 
```

为 zipfile.ZIP_DEFLATED（这指定了 deflate 压缩算法，它对各种类型的数据都很有效）

**w  就是擦除 所有原有的内容，a只将文件添加到原有的 ZIP 文件中**

就像写入文件一样，写模式将擦除 ZIP 文件中所有原有的内容。

如果 只是希望将文件添加到原有的 ZIP 文件中，就要向 zipfile.ZipFile()传入'a'作为第二个参数，以添加模式打开 ZIP 文件。



# 第10章 调试

### 抛出异常

抛出异常使用 raise 语句。在代码中，raise 语句包含以下部分：
 • raise 关键字；
 • 对 Exception 函数的调用；
 • 传递给 Exception 函数的字符串，包含有用的出错信息。

**#raise Exception('This is the error message.')**



#### 取得反向跟踪的字符串

如果 Python 遇到错误，它就会生成一些错误信息，称为“反向跟踪”。

#### 断言

，assert 语句是说：“我断言这个条件为真，如果不为真，程序中什
 么地方就有一个缺陷。”不像异常，代码不应该用 try 和 except 处理 assert 语句。如果
 assert 失败，程序就应该崩溃

```
语法格式如下：

assert expression
等价于：

if not expression:
    raise AssertionError
assert 后面也可以紧跟参数:

assert expression [, arguments]
等价于：

if not expression:
    raise AssertionError(arguments)
```

#### 禁用断言

在运行 Python 时传入-O 选项，可以禁用断言。

#### 使用日志模块

要启用 logging 模块，

```python
import logging
 logging.basicConfig(level=logging.DEBUG, format=' %(asctime)s - %(levelname)s
 - %(message)s')
 logging.debug('Start of program')
 def factorial(n):
  logging.debug('Start of factorial(%s%%)' % (n))
  total = 1
  for i in range(n + 1):
  total *= i
  logging.debug('i is ' + str(i) + ', total is ' + str(total))
  logging.debug('End of factorial(%s%%)' % (n))
  return total
 print(factorial(5))
 logging.debug('End of program')
```

#### 日志级别

DEBUG  logging.debug()  最低级别。用于小细节。通常只有在诊断问题时，你才会关心这些消息
 INFO  logging.info()  用于记录程序中一般事件的信息，或确认一切工作正常

WARNING  logging.warning()  用于表示可能的问题，它不会阻止程序的工作，但将来可能会
 ERROR  logging.error()  用于记录错误，它导致程序做某事失败
 CRITICAL  logging.critical()  最高级别。用于表示致命的错误，它导致或将要导致程序完全停止
 工作

#### 禁用日志

如果想要禁用所有日志，只要在程序中添加 logging. disable
 （logging.CRITICAL）。

>>> logging.disable(logging.CRITICAL)
>>> 

#### 将日志记录到文件

```
import logging
 logging.basicConfig(filename='myProgramLog.txt', level=logging.DEBUG, format='
 %(asctime)s - %(levelname)s - %(message)s')
```

# 第11  章  从 Web 抓取信息



**webbrowser：是 Python 自带的，打开浏览器获取指定页面。
 requests：从因特网上下载文件和网页。
Beautiful Soup：解析 HTML，即网页编写的格式。
 selenium：启动并控制一个 Web 浏览器。selenium 能够填写表单，并模拟鼠标
 在这个浏览器中点击。**



#### 项目：利用 webbrowser 模块的 mapIt.py

```python
>>> import webbrowser
 >>> webbrowser.open('http://inventwithpython.com/')
 Web 浏览器的选项卡将打开 URL http://inventwithpython.com/。
```

#### 用 requests 模块从 Web 下载文件

```
import requests
  >>> res = requests.get('http://www.gutenberg.org/cache/epub/1112/pg1112.txt')
 >>> type(res)
 <class 'requests.models.Response'>
  >>> res.status_code == requests.codes.ok
 True
 >>> len(res.text)
 178981
 >>> print(res.text[:250])
 The Project Gutenberg EBook of Romeo and Juliet, by William Shakespeare
 This eBook is for the use of anyone anywhere at no cost and with
 almost no restrictions whatsoever. You may copy it, give it away or
 re-use it under the terms of the Proje
```



# 第 12 章  处理 Excel 电子表格

#### 安装 openpyxl 模块

 **import openpyxl**

```
>>> import openpyxl
 >>> wb = openpyxl.load_workbook('example.xlsx')
 >>> type(wb)
 <class 'openpyxl.workbook.workbook.Workbook'>
 
 os.getcwd()弄清楚当前工作目录是什么，并使用 os.chdir()改变当前工作目录。
```



#### 从工作簿中取得工作表

```
import openpyxl

wb = openpyxl.load_workbook('example.xlsx')
wb.get_sheet_names()
  *** ['Sheet1', 'Sheet2', 'Sheet3']
sheet = wb.get_sheet_by_name('Sheet3')
sheet
sheet.title
**** 'Sheet3'
 >>> anotherSheet = wb.get_active_sheet()
 >>> anotherSheet
 <Worksheet "Sheet1">
```



**get_active_sheet()方法，取得工作簿的活动表**

在取得 Worksheet对象后，可以通过 title 属性取得它的名称。

#### 从表中取得单元格

```
import openpyxl
 >>> wb = openpyxl.load_workbook('example.xlsx')
 >>> sheet = wb.get_sheet_by_name('Sheet1')
 >>> sheet['A1']
 <Cell Sheet1.A1>
 >>> sheet['A1'].value
 datetime.datetime(2015, 4, 5, 13, 34, 2)
 >>> c = sheet['B1']
 >>> c.value
 'Apples'
 >>> 'Row ' + str(c.row) + ', Column ' + c.column + ' is ' + c.value
 'Row 1, Column B is Apples'
 >>> 'Cell ' + c.coordinate + ' is ' + c.value
 'Cell B1 is Apples'
 >>> >>> sheet['C1'].value
 73
 
 
 
 sheet.cell(row=1, column=2)
 <Cell Sheet1.B1>
 >>> sheet.cell(row=1, column=2).value
 'Apples'
 >>> for i in range(1, 8, 2):
 print(i, sheet.cell(row=i, column=2).value)
 1 Apples
 3 Pears
 5 Apples
 7 Strawberries
 
 
 
 >>> import openpyxl
 >>> wb = openpyxl.load_workbook('example.xlsx')
 >>> sheet = wb.get_sheet_by_name('Sheet1')
 >>> sheet.get_highest_row()
 7
 >>> sheet.get_highest_column()
 3
 请注意，get_highest_column()方法返回一个整数，而不是 Excel 中出现的字母。
```



#### 列字母和数字之间的转换

要从字母转换到数字，就调用 openpyxl.cell.column_index_from_string()函数

要从数字转换到字母，就调用 openpyxl.cell.get_column_letter()函数。

```
>>> import openpyxl
 >>> from openpyxl.cell import get_column_letter, column_index_from_string
 >>> get_column_letter(1)
 'A'
 >>> get_column_letter(2)
 'B'
 >>> get_column_letter(27)
 'AA'
 >>> get_column_letter(900)
 'AHP'
 >>> wb = openpyxl.load_workbook('example.xlsx')
 >>> sheet = wb.get_sheet_by_name('Sheet1')
 >>> get_column_letter(sheet.get_highest_column())
 'C'
 >>> column_index_from_string('A')
 1
 >>> column_index_from_string('AA')
 27
```

#### 从表中取得行和列

可以将 Worksheet 对象切片，取得电子表格中一行、一列或一个矩形区域中的所有
 Cell 对象。然后可以循环遍历这个切片中的所有单元格。

```python
>>> import openpyxl
 >>> wb = openpyxl.load_workbook('example.xlsx')
 >>> sheet = wb.get_sheet_by_name('Sheet1')
 >>> tuple(sheet['A1':'C3'])
 ((<Cell Sheet1.A1>, <Cell Sheet1.B1>, <Cell Sheet1.C1>), (<Cell Sheet1.A2>,
 <Cell Sheet1.B2>, <Cell Sheet1.C2>), (<Cell Sheet1.A3>, <Cell Sheet1.B3>,
 <Cell Sheet1.C3>))
  >>> for rowOfCellObjects in sheet['A1':'C3']:
  for cellObj in rowOfCellObjects:
 print(cellObj.coordinate, cellObj.value)
 print('--- END OF ROW ---')
    
    
    >>> import openpyxl
 >>> wb = openpyxl.load_workbook('example.xlsx')
 >>> sheet = wb.get_active_sheet()
 >>> sheet.columns[1]
 (<Cell Sheet1.B1>, <Cell Sheet1.B2>, <Cell Sheet1.B3>, <Cell Sheet1.B4>,
 <Cell Sheet1.B5>, <Cell Sheet1.B6>, <Cell Sheet1.B7>)
 >>> for cellObj in sheet.columns[1]:
 print(cellObj.value)
   Apples
 Cherries
 Pears
 Oranges
 Apples
 Bananas
 Strawberries 
    
    
    
1．导入 openpyxl 模块。
 2．调用 openpyxl.load_workbook()函数。
 3．取得 Workbook 对象。
 4．调用 get_active_sheet()或 get_sheet_by_name()工作簿方法。
 5．取得 Worksheet 对象。
 6．使用索引或工作表的 cell()方法，带上 row 和 column 关键字参数。
 7．取得 Cell 对象。
 8．读取 Cell 对象的 value 属性。
 
 
```



#### 12.5.1 创建并保存 Excel 文档

```
>>> import openpyxl
 >>> wb = openpyxl.Workbook()
 >>> wb.get_sheet_names()
 ['Sheet']
 >>> sheet = wb.get_active_sheet()
 >>> sheet.title
 
 'Sheet'
 >>> sheet.title = 'Spam Bacon Eggs Sheet'
 >>> wb.get_sheet_names()
 ['Spam Bacon Eggs Sheet']
 
 
 
 将文件名作为字符串传递给 save()方法。
 >>> import openpyxl
 >>> wb = openpyxl.load_workbook('example.xlsx')
 >>> sheet = wb.get_active_sheet()
 >>> sheet.title = 'Spam Spam Spam'
 >>> wb.save('example_copy.xlsx')
 
 
 
```

#### 创建和删除工作表

 **create_sheet() and remove_sheet()方法，可以在工作簿中添加或删除工作表。**

```python
>>> import openpyxl
 >>> wb = openpyxl.Workbook()
 >>> wb.get_sheet_names()
 ['Sheet']
 >>> wb.create_sheet()
 <Worksheet "Sheet1">
 >>> wb.get_sheet_names()
 ['Sheet', 'Sheet1']
 >>> wb.create_sheet(index=0, title='First Sheet')
 <Worksheet "First Sheet">
 >>> wb.get_sheet_names()
 ['First Sheet', 'Sheet', 'Sheet1']
 >>> wb.create_sheet(index=2, title='Middle Sheet')
 <Worksheet "Middle Sheet">
 >>> wb.get_sheet_names()
 ['First Sheet', 'Sheet', 'Middle Sheet', 'Sheet1']


>>> wb.get_sheet_names()
 ['First Sheet', 'Sheet', 'Middle Sheet', 'Sheet1']
 >>> wb.remove_sheet(wb.get_sheet_by_name('Middle Sheet'))
 >>> wb.remove_sheet(wb.get_sheet_by_name('Sheet1'))
 >>> wb.get_sheet_names()
 ['First Sheet', 'Sheet']
    

```

#### 将值写入单元格 

```
>>> import openpyxl
 >>> wb = openpyxl.Workbook()
 >>> sheet = wb.get_sheet_by_name('Sheet')
 >>> sheet['A1'] = 'Hello world!'
 >>> sheet['A1'].value
 'Hello world!'
```



## 第 13 章 处理 PDF 和 Word 文档

#### 从 PDF 提取文本 

```
 import PyPDF2

>>> import PyPDF2
 >>> pdfFileObj = open('meetingminutes.pdf', 'rb')
 >>> pdfReader = PyPDF2.PdfFileReader(pdfFileObj)
  >>> pdfReader.numPages
 19
  >>> pageObj = pdfReader.getPage(0)
  >>> pageObj.extractText()
 'OOFFFFIICCIIAALL BBOOAARRDD MMIINNUUTTEESS Meeting of March 7, 2015
\n The Board of Elementary and Secondary Education shall provide leadership
 and create policies for education that expand opportunities for children,
 empower families and communities, and advance Louisiana in an increasingly
 competitive global market. BOARD of ELEMENTARY and SECONDARY EDUCATION '

```

#### 解密 PDF

```
要读取加密的 PDF，就调用 decrypt()函数，



>>> import PyPDF2
 >>> pdfReader = PyPDF2.PdfFileReader(open('encrypted.pdf', 'rb'))
  >>> pdfReader.isEncrypted
 True
 >>> pdfReader.getPage(0)
  Traceback (most recent call last):
 File "<pyshell#173>", line 1, in <module>
 pdfReader.getPage()
 --snip--
 File "C:\Python34\lib\site-packages\PyPDF2\pdf.py", line 1173, in getObject
 raise utils.PdfReadError("file has not been decrypted")
 PyPDF2.utils.PdfReadError: file has not been decrypted
  >>> pdfReader.decrypt('rosebud')
 1 >>> pageObj = pdfReader.getPage(0)
```

#### 创建 PDF

```

 在 PyPDF2 中，与 PdfFileReader 对象相对的是 PdfFileWriter 对象，它可以创建
 一个新的 PDF 文件。
 
 
 模块不允许直接编辑 PDF。必须创建一个新的 PDF，然后从已有的文档拷贝内 容。本节的例子将遵循这种一般方式：
 1．打开一个或多个已有的 PDF（源 PDF），得到 PdfFileReader 对象。
 2．创建一个新的 PdfFileWriter 对象。
 3．将页面从 PdfFileReader 对象拷贝到 PdfFileWriter 对象中。
 4．最后，利用 PdfFileWriter 对象写入输出的 PDF。
 
 
 
```

#### 拷贝页面

```
可以利用 PyPDF2，从一个 PDF 文档拷贝页面到另一个 PDF 文档。这让你能够
 组合多个 PDF 文件，去除不想要的页面，或调整页面的次序。
 
 >>> import PyPDF2
 >>> pdf1File = open('meetingminutes.pdf', 'rb')
 >>> pdf2File = open('meetingminutes2.pdf', 'rb')
  >>> pdf1Reader = PyPDF2.PdfFileReader(pdf1File)
  >>> pdf2Reader = PyPDF2.PdfFileReader(pdf2File)
  >>> pdfWriter = PyPDF2.PdfFileWriter()
 >>> for pageNum in range(pdf1Reader.numPages):
  pageObj = pdf1Reader.getPage(pageNum)
  pdfWriter.addPage(pageObj)
 >>> for pageNum in range(pdf2Reader.numPages):
  pageObj = pdf2Reader.getPage(pageNum)
  pdfWriter.addPage(pageObj)
  >>> pdfOutputFile = open('combinedminutes.pdf', 'wb')
 >>> pdfWriter.write(pdfOutputFile)
 >>> pdfOutputFile.close()
 >>> pdf1File.close()
 >>> pdf2File.close()
  
 
```

#### 旋转页面

```
利用 rotateClockwise()和 rotateCounterClockwise()方法，PDF 文档的页面也可以
 旋转 90 度的整数倍。向这些方法传入整数 90、180 或 270 就可以了。
 
 >>> import PyPDF2
 >>> minutesFile = open('meetingminutes.pdf', 'rb')
 >>> pdfReader = PyPDF2.PdfFileReader(minutesFile)
  >>> page = pdfReader.getPage(0)
  >>> page.rotateClockwise(90)
 {'/Contents': [IndirectObject(961, 0), IndirectObject(962, 0),
 --snip--
 } >>> pdfWriter = PyPDF2.PdfFileWriter()
 >>> pdfWriter.addPage(page)
 
 >>> resultPdfFile = open('rotatedPage.pdf', 'wb')
 >>> pdfWriter.write(resultPdfFile)
 >>> resultPdfFile.close()
 >>> minutesFile.close()
 
```

#### 叠加页面

```
PyPDF2 也可以将一页的内容叠加到另一页上，这可以用来在页面上添加公司标志、时间戳或水印
 
 >>> import PyPDF2
 >>> minutesFile = open('meetingminutes.pdf', 'rb')
  >>> pdfReader = PyPDF2.PdfFileReader(minutesFile)
  >>> minutesFirstPage = pdfReader.getPage(0)
  >>> pdfWatermarkReader = PyPDF2.PdfFileReader(open('watermark.pdf', 'rb'))>>> minutesFirstPage.mergePage(pdfWatermarkReader.getPage(0))
  >>> pdfWriter = PyPDF2.PdfFileWriter()
  >>> pdfWriter.addPage(minutesFirstPage)
  >>> for pageNum in range(1, pdfReader.numPages):
 pageObj = pdfReader.getPage(pageNum)
 pdfWriter.addPage(pageObj)
 >>> resultPdfFile = open('watermarkedCover.pdf', 'wb')
 >>> pdfWriter.write(resultPdfFile)
 >>> minutesFile.close()
 >>> resultPdfFile.close()
 
 >>> minutesFirstPage.mergePage(pdfWatermarkReader.getPage(0))
  >>> pdfWriter = PyPDF2.PdfFileWriter()
  >>> pdfWriter.addPage(minutesFirstPage)
  >>> for pageNum in range(1, pdfReader.numPages):
 pageObj = pdfReader.getPage(pageNum)
 pdfWriter.addPage(pageObj)
 >>> resultPdfFile = open('watermarkedCover.pdf', 'wb')
 >>> pdfWriter.write(resultPdfFile)
 >>> minutesFile.close()
 >>> resultPdfFile.close()
 
 这里我们生成了 meetingminutes.pdf 的 PdfFileReader 对象。
 调用 getPage(0)， 取得第一页的Page 对象，并将它保存在 minutesFirstPage 中
 。然后生成了 watermark.pd 
 的PdfFileReader 对象
 ，并在minutesFirstPage 上调用mergePage()
 。传递给mergePage()
 的参数，是 watermark.pdf 第一页的 Page 对象。
 既然我们已经在 minutesFirstPage 上调用了 mergePage()，minutesFirstPage 就代
 表加了水印的第一页。我们创建一个 PdfFileWriter 对象
 ，并加入加了水印的第一页
 。 然后循环遍历 meetingminutes.pdf 的剩余页面，将它们添加到 PdfFileWriter 对象中
 。 最后，我们打开一个新的 PDF 文件 watermarkedCover.pdf，并将 PdfFileWriter 的内容写
 入该文件。
 
```

#### 加密 PDF

```
>>> import PyPDF2
 >>> pdfFile = open('meetingminutes.pdf', 'rb')
 >>> pdfReader = PyPDF2.PdfFileReader(pdfFile)
 >>> pdfWriter = PyPDF2.PdfFileWriter()
 >>> for pageNum in range(pdfReader.numPages):
 pdfWriter.addPage(pdfReader.getPage(pageNum))
  >>> pdfWriter.encrypt('swordfish')
 >>> resultPdf = open('encryptedminutes.pdf', 'wb')
 >>> pdfWriter.write(resultPdf)
 >>> resultPdf.close()
 
 调用 encrypt()方法，传入口令字符串
 在这个例子中，我们将 meetingminutes.pdf 的页面拷贝到 PdfFileWriter 对象。用口
 令 swordfish 加密了 PdfFileWriter，打开了一个名为 encryptedminutes.pdf 的新 PDF，将
 PdfFileWriter 的内容写入新 PDF。任何人要查看 encryptedminutes.pdf，都必须输入这个
 口令。在确保文件的拷贝被正确加密后，你可能会删除原来的未加密的文件。
```

####  项目：从多个 PDF 中合并选择的页面

总的来说，该程序需要完成：
  找到当前工作目录中所有 PDF 文件。
  按文件名排序，这样就能有序地添加这些 PDF。  除了第一页之外，将每个 PDF 的所有页面写入输出的文件。
 从实现的角度来看，代码需要完成下列任务：
  调用 os.listdir()，找到当前工作目录中的所有文件，去除掉非 PDF 文件。
  调用 Python 的 sort()列表方法，对文件名按字母排序。
  为输出的 PDF 文件创建 PdfFileWriter 对象。
  循环遍历每个 PDF 文件，为它创建 PdfFileReader 对象。
  针对每个 PDF 文件，循环遍历每一页，第一页除外。
  将页面添加到输出的 PDF。  将输出的 PDF 写入一个文件，名为 allminutes.pdf。 针对这个项目，打开一个新的文件编辑器窗口，将它保存为 combinePdfs.py。

## Word 文档

**pip install python-docx**

**import docx**

#### 读取 Word 文档

```
>>> import docx
  >>> doc = docx.Document('demo.docx')#在 Python 中打开了一个.docx 文件，
  >>> len(doc.paragraphs)#将返回 7。这告诉我们，该文档有 7 个 Paragraph 对象
 7
  >>> doc.paragraphs[0].text#每个 Paragraph 对象都有一个 text 属性，包含该段中文本
 的字符串（没有样式信息）。这里，第一个 text 属性包含'DocumentTitle
 'Document Title'
  >>> doc.paragraphs[1].text，#第二个包含'A plain paragraph with some bold and some italic'
 'A plain paragraph with some bold and some italic'
  >>> len(doc.paragraphs[1].runs)# 返回4，含义是有4个run对象
 4
  >>> doc.paragraphs[1].runs[0].text
 'A plain paragraph with some '
  >>> doc.paragraphs[1].runs[1].text
 'bold'
  >>> doc.paragraphs[1].runs[2].text
 ' and some '
 第一个对象包含'A plain paragraph with some '。然
 后，文本变为粗体样式，所以’bold’开始了一个新的 Run 对象。在这之后，文本
 又回到了非粗体的样式，这导致了第三个 Run 对象，' and some
 
  >>> doc.paragraphs[1].runs[3].text。#最后，第四个对象包含'italic'，是斜体样式
 'italic'
```

#### 从.docx 文件中取得完整的文本